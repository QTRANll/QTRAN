{
    "HTML": [
        "https://www.oceanbase.com/docs/enterprise-oceanbase-database-cn-1000000001054292"
    ],
    "Title": [
        "EXPLAIN"
    ],
    "Feature": [
        "/*获取表或列的信息*/\n{EXPLAIN | DESCRIBE | DESC} table_name [column_name];\n\n/*获取 SQL 计划信息*/\n{EXPLAIN [INTO table_name ] [SET statement_id = string]  \n | DESCRIBE\n | DESC} [explain_type] [PRETTY | PRETTY_COLOR] dml_statement;\n\nexplain_type：\n    BASIC\n  | OUTLINE\n  | EXTENDED\n  | EXTENDED_NOADDR\n  | PARTITIONS\n  | FORMAT = {TRADITIONAL| JSON}\n\ndml_statement:\n    SELECT statement\n  | DELETE statement\n  | INSERT statement\n  | UPDATE statement\n  | MERGE statement\n"
    ],
    "Description": [
        "该语句用于解释 SQL 语句的执行计划，可以是 SELECT、DELETE、INSERT、REPLACE 或 UPDATE 语句。",
        "EXPLAIN 与 DESCRIBE、DESC 互为同义词。",
        "\n\n\n参数\n描述\n\n\n\n\ntable_name\n指定表名。\n\n\ncolumn_name\n指定表的列名。\n\n\nINTO table_name\n表示将 EXPLAIN 的计划信息保存到指定表内。如果没有指定 INTO table_name，默认查询到 PLAN_TABLE 表内。\n\n\nSET statement_id\n表示当前查询使用字符串标记，以方便后续查询该 SQL 的计划信息。如果没有指定 SET statement_id，默认使用空字符串作为信息标记。\n\n\nPRETTY | PRETTY_COLOR\n将计划树中的父节点和子节点使用树线或彩色树线连接起来，使得执行计划展示更方便阅读。\n\n\nBASIC\n指定输出计划的基础信息，如算子 ID、算子名称、所引用的表名。\n\n\nexplain_type\n指定解释类型。\n\n\nBASIC\n指定输出计划的基础信息，例如算子 ID、算子名称、所引用的表名。\n\n\nOUTLINE\n指定输出的计划信息包含 Outline 信息。\n\n\nEXTENDED\nEXPLAIN 产生附加信息，包括每个算子的输入列和输出列、访问表的分区信息、当前使用的filter信息。如果当前算子使用了索引，显示所使用的索引列及抽取的 Query Range。\n\n\nEXTENDED_NOADDR\n以简约的方式展示附加信息。\n\n\nPARTITIONS\n显示分区相关信息。\n\n\nTRADITIONAL | JSON\n指定 EXPALIN 的输出格式。 \n      \nTRADITIONAL：表格输出格式。\nJSON：使用 KEY:VALUE 输出格式，JSON 显示为JSON 字符串，包括 EXTENDED 和 PARTITIONS 信息。\n\n\n\ndml_statement\nDML 语句。\n\n\n"
    ],
    "Examples": [
        "/* 创建表 test */\nobclient> CREATE TABLE test (statement_id VARCHAR(30), plan_id INT, gmt_create TIMESTAMP,\n   remarks VARCHAR(4000), operator VARCHAR(255), options VARCHAR(255), object_node VARCHAR(40),\n   object_owner VARCHAR(128), object_name VARCHAR(128), object_alias VARCHAR(261), object_instance INT,\n   object_type VARCHAR(30),optimizer VARCHAR(4000), search_columns INT, id INT, parent_id INT, depth INT,\n   position INT,is_last_child INT, cost INT, cardinality INT, bytes INT, rowset INT, other_tag VARCHAR(4000),\n   partition_start VARCHAR(4000), partition_stop VARCHAR(4000), partition_id INT, other VARCHAR(4000),\n   distribution VARCHAR(64), cpu_cost INT, io_cost INT, temp_space INT, access_predicates VARCHAR(4000),\n   filter_predicates VARCHAR(4000),startup_predicates VARCHAR(4000), projection VARCHAR(4000),\n   special_predicates VARCHAR(4000), time INT, qblock_name VARCHAR(128), other_xml VARCHAR(4000));\nQuery OK, 0 rows affected\n\nobclient> CREATE TABLE t1(c1 INT);\nQuery OK, 0 rows affected\n\n/* 如果时间格式报错，可以通过如下命令重新设置 TIMESTAMP 格式*/\nobclient> ALTER SESSION SET NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF';\nQuery OK, 0 rows affected\n\n/* 解释查询计划，并把计划信息保存在指定表 test 内 */\nobclient> EXPLAIN INTO test SELECT COUNT(*) FROM t1;\n+--------------------------------------------------------------------------+\n| Query Plan                                                               |\n+--------------------------------------------------------------------------+\n| =================================================                        |\n| |ID|OPERATOR         |NAME|EST.ROWS|EST.TIME(us)|                        |\n| -------------------------------------------------                        |\n| |0 |SCALAR GROUP BY  |    |1       |2           |                        |\n| |1 |└─TABLE FULL SCAN|T1  |1       |2           |                        |\n| =================================================                        |\n| Outputs & filters:                                                       |\n| -------------------------------------                                    |\n|   0 - output([T_FUN_COUNT_SUM(T_FUN_COUNT(*))]), filter(nil), rowset=256 |\n|       group(nil), agg_func([T_FUN_COUNT_SUM(T_FUN_COUNT(*))])            |\n|   1 - output([T_FUN_COUNT(*)]), filter(nil), rowset=256                  |\n|       access(nil), partitions(p0)                                        |\n|       is_index_back=false, is_global_index=false,                        |\n|       range_key([T1.__pk_increment]), range(MIN ; MAX)always true        |\n+--------------------------------------------------------------------------+\n14 rows in set\n\nobclient> SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY(table_name=>'test'));\n+--------------------------------------------------------------------------+\n| COLUMN_VALUE                                                             |\n+--------------------------------------------------------------------------+\n| =================================================                        |\n| |ID|OPERATOR         |NAME|EST.ROWS|EST.TIME(us)|                        |\n| -------------------------------------------------                        |\n| |0 |SCALAR GROUP BY  |    |1       |2           |                        |\n| |1 |└─TABLE FULL SCAN|T1  |1       |2           |                        |\n| =================================================                        |\n| Outputs & filters:                                                       |\n| -------------------------------------                                    |\n|   0 - output([T_FUN_COUNT_SUM(T_FUN_COUNT(*))]), filter(nil), rowset=256 |\n|       group(nil), agg_func([T_FUN_COUNT_SUM(T_FUN_COUNT(*))])            |\n|   1 - output([T_FUN_COUNT(*)]), filter(nil), rowset=256                  |\n|       access(nil), partitions(p0)                                        |\n|       is_index_back=false, is_global_index=false,                        |\n|       range_key([T1.__pk_increment]), range(MIN ; MAX)always true        |\n+--------------------------------------------------------------------------+\n14 rows in set\n",
        "obclient> EXPLAIN INTO test SET statement_id='test2' SELECT COUNT(*) FROM t1;\n+--------------------------------------------------------------------------+\n| Query Plan                                                               |\n+--------------------------------------------------------------------------+\n| =================================================                        |\n| |ID|OPERATOR         |NAME|EST.ROWS|EST.TIME(us)|                        |\n| -------------------------------------------------                        |\n| |0 |SCALAR GROUP BY  |    |1       |2           |                        |\n| |1 |└─TABLE FULL SCAN|T1  |1       |2           |                        |\n| =================================================                        |\n| Outputs & filters:                                                       |\n| -------------------------------------                                    |\n|   0 - output([T_FUN_COUNT_SUM(T_FUN_COUNT(*))]), filter(nil), rowset=256 |\n|       group(nil), agg_func([T_FUN_COUNT_SUM(T_FUN_COUNT(*))])            |\n|   1 - output([T_FUN_COUNT(*)]), filter(nil), rowset=256                  |\n|       access(nil), partitions(p0)                                        |\n|       is_index_back=false, is_global_index=false,                        |\n|       range_key([T1.__pk_increment]), range(MIN ; MAX)always true        |\n+--------------------------------------------------------------------------+\n14 rows in set\n\nobclient> SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY(table_name=>'test',statement_id=>'test2'));\n+--------------------------------------------------------------------------+\n| COLUMN_VALUE                                                             |\n+--------------------------------------------------------------------------+\n| =================================================                        |\n| |ID|OPERATOR         |NAME|EST.ROWS|EST.TIME(us)|                        |\n| -------------------------------------------------                        |\n| |0 |SCALAR GROUP BY  |    |1       |2           |                        |\n| |1 |└─TABLE FULL SCAN|T1  |1       |2           |                        |\n| =================================================                        |\n| Outputs & filters:                                                       |\n| -------------------------------------                                    |\n|   0 - output([T_FUN_COUNT_SUM(T_FUN_COUNT(*))]), filter(nil), rowset=256 |\n|       group(nil), agg_func([T_FUN_COUNT_SUM(T_FUN_COUNT(*))])            |\n|   1 - output([T_FUN_COUNT(*)]), filter(nil), rowset=256                  |\n|       access(nil), partitions(p0)                                        |\n|       is_index_back=false, is_global_index=false,                        |\n|       range_key([T1.__pk_increment]), range(MIN ; MAX)always true        |\n+--------------------------------------------------------------------------+\n14 rows in set\n",
        "obclient> CREATE TABLE t101(c1 INT,c2 INT);\nQuery OK, 0 rows affected\n\nobclient> CREATE TABLE t102(c1 INT,c2 INT);\nQuery OK, 0 rows affected\n",
        "obclient> EXPLAIN t101;\n+-------+------------+------+-----+---------+-------+\n| FIELD | TYPE       | NULL | KEY | DEFAULT | EXTRA |\n+-------+------------+------+-----+---------+-------+\n| C1    | NUMBER(38) | YES  | NULL | NULL    | NULL |\n| C2    | NUMBER(38) | YES  | NULL | NULL    | NULL |\n+-------+------------+------+-----+---------+-------+\n2 rows in set\n",
        "obclient> EXPLAIN t102 c2;\n+-------+------------+------+-----+---------+-------+\n| FIELD | TYPE       | NULL | KEY | DEFAULT | EXTRA |\n+-------+------------+------+-----+---------+-------+\n| C2    | NUMBER(38) | YES  | NULL | NULL    | NULL |\n+-------+------------+------+-----+---------+-------+\n\n1 row in set\n",
        "+------------------------------------------------------------------------------------+\n| Query Plan                                                                         |\n+------------------------------------------------------------------------------------+\n| =================================================                                  |\n| |ID|OPERATOR         |NAME|EST.ROWS|EST.TIME(us)|                                  |\n| -------------------------------------------------                                  |\n| |0 |HASH JOIN        |    |1       |8           |                                  |\n| |1 |├─TABLE FULL SCAN|T102|1       |4           |                                  |\n| |2 |└─TABLE FULL SCAN|T101|1       |4           |                                  |\n| =================================================                                  |\n| Outputs & filters:                                                                 |\n| -------------------------------------                                              |\n|   0 - output([T101.C1], [T101.C2], [T102.C1], [T102.C2]), filter(nil), rowset=16   |\n|       equal_conds([T101.C2 = T102.C2]), other_conds(nil)                           |\n|   1 - output([T102.C2], [T102.C1]), filter([T102.C1 > 4]), rowset=16               |\n|       access([T102.C2], [T102.C1]), partitions(p0)                                 |\n|       is_index_back=false, is_global_index=false, filter_before_indexback[false],  |\n|       range_key([T102.__pk_increment]), range(MIN ; MAX)always true                |\n|   2 - output([T101.C2], [T101.C1]), filter(nil), rowset=16                         |\n|       access([T101.C2], [T101.C1]), partitions(p0)                                 |\n|       is_index_back=false, is_global_index=false,                                  |\n|       range_key([T101.__pk_increment]), range(MIN ; MAX)always true                |\n+------------------------------------------------------------------------------------+\n",
        "obclient> EXPLAIN EXTENDED_NOADDR SELECT * FROM t101,t102 WHERE t101.c2=t102.c2 AND t102.c1 > 4;\n+------------------------------------------------------------------------------------+\n| Query Plan                                                                         |\n+------------------------------------------------------------------------------------+\n| =================================================                                  |\n| |ID|OPERATOR         |NAME|EST.ROWS|EST.TIME(us)|                                  |\n| -------------------------------------------------                                  |\n| |0 |HASH JOIN        |    |1       |8           |                                  |\n| |1 |├─TABLE FULL SCAN|T102|1       |4           |                                  |\n| |2 |└─TABLE FULL SCAN|T101|1       |4           |                                  |\n| =================================================                                  |\n| Outputs & filters:                                                                 |\n| -------------------------------------                                              |\n|   0 - output([T101.C1], [T101.C2], [T102.C1], [T102.C2]), filter(nil), rowset=16   |\n|       equal_conds([T101.C2 = T102.C2]), other_conds(nil)                           |\n|   1 - output([T102.C2], [T102.C1]), filter([T102.C1 > 4]), rowset=16               |\n|       access([T102.C2], [T102.C1]), partitions(p0)                                 |\n|       is_index_back=false, is_global_index=false, filter_before_indexback[false],  |\n|       range_key([T102.__pk_increment]), range(MIN ; MAX)always true                |\n|   2 - output([T101.C2], [T101.C1]), filter(nil), rowset=16                         |\n|       access([T101.C2], [T101.C1]), partitions(p0)                                 |\n|       is_index_back=false, is_global_index=false,                                  |\n|       range_key([T101.__pk_increment]), range(MIN ; MAX)always true                |\n| Used Hint:                                                                         |\n| -------------------------------------                                              |\n|   /*+                                                                              |\n|                                                                                    |\n|   */                                                                               |\n| Qb name trace:                                                                     |\n| -------------------------------------                                              |\n|   stmt_id:0, stmt_type:T_EXPLAIN                                                   |\n|   stmt_id:1, SEL$1                                                                 |\n| Outline Data:                                                                      |\n| -------------------------------------                                              |\n|   /*+                                                                              |\n|       BEGIN_OUTLINE_DATA                                                           |\n|       LEADING(@\"SEL$1\" (\"SYS\".\"T102\"@\"SEL$1\" \"SYS\".\"T101\"@\"SEL$1\"))                |\n|       USE_HASH(@\"SEL$1\" \"SYS\".\"T101\"@\"SEL$1\")                                      |\n|       FULL(@\"SEL$1\" \"SYS\".\"T102\"@\"SEL$1\")                                          |\n|       FULL(@\"SEL$1\" \"SYS\".\"T101\"@\"SEL$1\")                                          |\n|       OPTIMIZER_FEATURES_ENABLE('4.0.0.0')                                         |\n|       END_OUTLINE_DATA                                                             |\n|   */                                                                               |\n| Optimization Info:                                                                 |\n| -------------------------------------                                              |\n|   T102:                                                                            |\n|       table_rows:1                                                                 |\n|       physical_range_rows:1                                                        |\n|       logical_range_rows:1                                                         |\n|       index_back_rows:0                                                            |\n|       output_rows:0                                                                |\n|       table_dop:1                                                                  |\n|       dop_method:Table DOP                                                         |\n|       avaiable_index_name:[T102]                                                   |\n|       stats version:0                                                              |\n|       dynamic sampling level:1                                                     |\n|   T101:                                                                            |\n|       table_rows:1                                                                 |\n|       physical_range_rows:1                                                        |\n|       logical_range_rows:1                                                         |\n|       index_back_rows:0                                                            |\n|       output_rows:1                                                                |\n|       table_dop:1                                                                  |\n|       dop_method:Table DOP                                                         |\n|       avaiable_index_name:[T101]                                                   |\n|       stats version:0                                                              |\n|       dynamic sampling level:1                                                     |\n|   Plan Type:                                                                       |\n|       LOCAL                                                                        |\n|   Note:                                                                            |\n|       Degree of Parallelisim is 1 because of table property                        |\n+------------------------------------------------------------------------------------+\n",
        "obclient> EXPLAIN FORMAT=TRADITIONAL INSERT INTO T101 VALUES(1,1);\n+----------------------------------------------------------------------------------------------------------------------------------------+\n| Query Plan                                                                                                                             |\n+----------------------------------------------------------------------------------------------------------------------------------------+\n| ==================================================                                                                                     |\n| |ID|OPERATOR          |NAME|EST.ROWS|EST.TIME(us)|                                                                                     |\n| --------------------------------------------------                                                                                     |\n| |0 |DISTRIBUTED INSERT|    |1       |13          |                                                                                     |\n| |1 |└─EXPRESSION      |    |1       |1           |                                                                                     |\n| ==================================================                                                                                     |\n| Outputs & filters:                                                                                                                     |\n| -------------------------------------                                                                                                  |\n|   0 - output(nil), filter(nil)                                                                                                         |\n|       columns([{T101: ({T101: (T101.__pk_increment, T101.C1, T101.C2)})}]),                                                            |\n|       column_values([T_HIDDEN_PK], [column_conv(NUMBER,PS:(-1,0),NULL,__values.C1)], [column_conv(NUMBER,PS:(-1,0),NULL,__values.C2)]) |\n|   1 - output([__values.C1], [__values.C2]), filter(nil)                                                                                |\n|       values({1, 1})                                                                                                                   |\n+----------------------------------------------------------------------------------------------------------------------------------------+\n",
        "obclient> EXPLAIN FORMAT=JSON SELECT * FROM t101,t102 WHERE t101.c2=t102.c2 AND t102.c1 > 4;\n+------------------------------------------------------------------+\n| Query Plan                                                       |\n+------------------------------------------------------------------+\n| {                                                                |\n|   \"ID\":0,                                                        |\n|   \"OPERATOR\":\"HASH JOIN \",                                       |\n|   \"NAME\":\"\",                                                     |\n|   \"EST.ROWS\":1,                                                  |\n|   \"EST.TIME(us)\":8,                                              |\n|   \"output\":\"output([T101.C1], [T101.C2], [T102.C1], [T102.C2])\", |\n|   \"CHILD_1\": {                                                   |\n|     \"ID\":1,                                                      |\n|     \"OPERATOR\":\"TABLE FULL SCAN\",                                |\n|     \"NAME\":\"T102\",                                               |\n|     \"EST.ROWS\":1,                                                |\n|     \"EST.TIME(us)\":4,                                            |\n|     \"output\":\"output([T102.C2], [T102.C1])\"                      |\n|   },                                                             |\n|   \"CHILD_2\": {                                                   |\n|     \"ID\":2,                                                      |\n|     \"OPERATOR\":\"TABLE FULL SCAN\",                                |\n|     \"NAME\":\"T101\",                                               |\n|     \"EST.ROWS\":1,                                                |\n|     \"EST.TIME(us)\":4,                                            |\n|     \"output\":\"output([T101.C2], [T101.C1])\"                      |\n|   }                                                              |\n| }                                                                |\n+------------------------------------------------------------------+\n"
    ],
    "Category": [
        "DML"
    ]
}