{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["CUME_DIST()"], "Feature": ["CUME_DIST()"], "Description": ["CUME_DIST()", "CUME_DIST() \u8ba1\u7b97\u4e00\u4e2a\u503c\u5728\u4e00\u7ec4\u503c\u4e2d\u7684\u7d2f\u79ef\u5206\u5e03\u3002\u8bf7\u6ce8\u610f\uff0c\u4f60\u9700\u8981\u5728 CUME_DIST() \u540e\u4f7f\u7528 ORDER BY \u5b50\u53e5\u5bf9\u8be5\u7ec4\u4e2d\u7684\u503c\u8fdb\u884c\u6392\u5e8f\u3002\u5426\u5219\uff0c\u6b64\u51fd\u6570\u5c06\u4e0d\u4f1a\u8fd4\u56de\u9884\u671f\u503c\u3002", "WITH RECURSIVE cte(n) AS (\n    SELECT 1\n    UNION\n    SELECT\n        n+2\n    FROM\n        cte\n    WHERE\n        n<6\n)\nSELECT\n    *,\n    CUME_DIST() OVER(ORDER BY n)\nFROM\n    cte;\n", "+------+------------------------------+\n| n    | CUME_DIST() OVER(ORDER BY n) |\n+------+------------------------------+\n|    1 |                         0.25 |\n|    3 |                          0.5 |\n|    5 |                         0.75 |\n|    7 |                            1 |\n+------+------------------------------+\n4 rows in set (0.00 sec)\n"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT 1\n    UNION\n    SELECT\n        n+2\n    FROM\n        cte\n    WHERE\n        n<6\n)\nSELECT\n    *,\n    CUME_DIST() OVER(ORDER BY n)\nFROM\n    cte;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["DENSE_RANK()"], "Feature": ["DENSE_RANK()"], "Description": ["DENSE_RANK()", "DENSE_RANK() \u51fd\u6570\u8fd4\u56de\u5f53\u524d\u884c\u7684\u6392\u540d\u3002\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e RANK()\uff0c\u4f46\u5728\u5904\u7406\u5177\u6709\u76f8\u540c\u503c\u548c\u6392\u5e8f\u6761\u4ef6\u7684\u884c\u65f6\u80fd\u591f\u786e\u4fdd\u6392\u540d\u662f\u8fde\u7eed\u7684\u3002", "SELECT\n    *,\n    DENSE_RANK() OVER (ORDER BY n)\nFROM (\n    SELECT 5 AS 'n'\n    UNION ALL\n    SELECT 8\n    UNION ALL\n    SELECT 5\n    UNION ALL\n    SELECT 30\n    UNION ALL\n    SELECT 31\n    UNION ALL\n    SELECT 32) a;\n", "+----+--------------------------------+\n| n  | DENSE_RANK() OVER (ORDER BY n) |\n+----+--------------------------------+\n|  5 |                              1 |\n|  5 |                              1 |\n|  8 |                              2 |\n| 30 |                              3 |\n| 31 |                              4 |\n| 32 |                              5 |\n+----+--------------------------------+\n6 rows in set (0.00 sec)\n"], "Examples": ["SELECT\n    *,\n    DENSE_RANK() OVER (ORDER BY n)\nFROM (\n    SELECT 5 AS 'n'\n    UNION ALL\n    SELECT 8\n    UNION ALL\n    SELECT 5\n    UNION ALL\n    SELECT 30\n    UNION ALL\n    SELECT 31\n    UNION ALL\n    SELECT 32) a;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["FIRST_VALUE()"], "Feature": ["FIRST_VALUE()"], "Description": ["FIRST_VALUE()", "FIRST_VALUE(expr) \u8fd4\u56de\u7a97\u53e3\u4e2d\u7684\u7b2c\u4e00\u4e2a\u503c\u3002"], "Examples": ["SELECT\n    n,\n    FIRST_VALUE(n) OVER (PARTITION BY n MOD 2 ORDER BY n),\n    FIRST_VALUE(n) OVER (PARTITION BY n <= 2 ORDER BY n)\nFROM (\n    SELECT 1 AS 'n'\n    UNION\n    SELECT 2\n    UNION\n    SELECT 3\n    UNION\n    SELECT 4\n) a\nORDER BY\n    n;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["LAG()"], "Feature": ["LAG()"], "Description": ["LAG()", "\u51fd\u6570 LAG(expr [, num [, default]]) \u8fd4\u56de\u5f53\u524d\u884c\u4e4b\u524d\u7b2c num \u884c\u7684 expr \u503c\u3002\u5982\u679c\u4e0d\u5b58\u5728\u8be5\u884c\uff0c\u5219\u8fd4\u56de default \u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u672a\u6307\u5b9a\u65f6\uff0cnum \u4e3a 1\uff0cdefault \u4e3a NULL\u3002"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT 1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n        n<10\n)\nSELECT\n    n,\n    LAG(n) OVER ()\nFROM\n    cte;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["LAST_VALUE()"], "Feature": ["LAST_VALUE()"], "Description": ["LAST_VALUE()", "LAST_VALUE() \u51fd\u6570\u8fd4\u56de\u7a97\u53e3\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u503c\u3002", "WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n        n<10\n)\nSELECT\n    n,\n    LAST_VALUE(n) OVER (PARTITION BY n<=5)\nFROM\n    cte\nORDER BY\n    n;\n", "+------+----------------------------------------+\n| n    | LAST_VALUE(n) OVER (PARTITION BY n<=5) |\n+------+----------------------------------------+\n|    1 |                                      5 |\n|    2 |                                      5 |\n|    3 |                                      5 |\n|    4 |                                      5 |\n|    5 |                                      5 |\n|    6 |                                     10 |\n|    7 |                                     10 |\n|    8 |                                     10 |\n|    9 |                                     10 |\n|   10 |                                     10 |\n+------+----------------------------------------+\n10 rows in set (0.00 sec)\n"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n        n<10\n)\nSELECT\n    n,\n    LAST_VALUE(n) OVER (PARTITION BY n<=5)\nFROM\n    cte\nORDER BY\n    n;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["LEAD()"], "Feature": ["LEAD()"], "Description": ["LEAD()", "\u51fd\u6570 LEAD(expr [, num [,default]]) \u8fd4\u56de\u5f53\u524d\u884c\u4e4b\u540e\u7b2c num \u884c\u7684 expr \u503c\u3002\u5982\u679c\u4e0d\u5b58\u5728\u8be5\u884c\uff0c\u5219\u8fd4\u56de default \u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u672a\u6307\u5b9a\u65f6\uff0cnum \u4e3a 1\uff0cdefault \u4e3a NULL\u3002"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n        n<10\n)\nSELECT\n    n,\n    LEAD(n) OVER ()\nFROM\n    cte;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["NTH_VALUE()"], "Feature": ["NTH_VALUE()"], "Description": ["NTH_VALUE()", "\u51fd\u6570 NTH_VALUE(expr, n) \u8fd4\u56de\u7a97\u53e3\u7684\u7b2c n \u4e2a\u503c\u3002", "WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n        n<10\n)\nSELECT\n    n,\n    FIRST_VALUE(n) OVER w AS 'First',\n    NTH_VALUE(n, 2) OVER w AS 'Second',\n    NTH_VALUE(n, 3) OVER w AS 'Third',\n    LAST_VALUE(n) OVER w AS 'Last'\nFROM\n    cte\nWINDOW\n    w AS (PARTITION BY n<=5)\nORDER BY\n    n;\n", "+------+-------+--------+-------+------+\n| n    | First | Second | Third | Last |\n+------+-------+--------+-------+------+\n|    1 |     1 |      2 |     3 |    5 |\n|    2 |     1 |      2 |     3 |    5 |\n|    3 |     1 |      2 |     3 |    5 |\n|    4 |     1 |      2 |     3 |    5 |\n|    5 |     1 |      2 |     3 |    5 |\n|    6 |     6 |      7 |     8 |   10 |\n|    7 |     6 |      7 |     8 |   10 |\n|    8 |     6 |      7 |     8 |   10 |\n|    9 |     6 |      7 |     8 |   10 |\n|   10 |     6 |      7 |     8 |   10 |\n+------+-------+--------+-------+------+\n10 rows in set (0.00 sec)\n"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n        n<10\n)\nSELECT\n    n,\n    FIRST_VALUE(n) OVER w AS 'First',\n    NTH_VALUE(n, 2) OVER w AS 'Second',\n    NTH_VALUE(n, 3) OVER w AS 'Third',\n    LAST_VALUE(n) OVER w AS 'Last'\nFROM\n    cte\nWINDOW\n    w AS (PARTITION BY n<=5)\nORDER BY\n    n;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["NTILE()"], "Feature": ["NTILE()"], "Description": ["NTILE()", "NTILE(n) \u51fd\u6570\u5c06\u7a97\u53e3\u5212\u5206\u4e3a n \u4e2a\u5206\u7ec4\uff0c\u5e76\u8fd4\u56de\u5404\u884c\u7684\u5206\u7ec4\u7f16\u53f7\u3002", "WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n    n<10\n)\nSELECT\n    n,\n    NTILE(5) OVER (),\n    NTILE(2) OVER ()\nFROM\n    cte;\n", "+------+------------------+------------------+\n| n    | NTILE(5) OVER () | NTILE(2) OVER () |\n+------+------------------+------------------+\n|    1 |                1 |                1 |\n|    2 |                1 |                1 |\n|    3 |                2 |                1 |\n|    4 |                2 |                1 |\n|    5 |                3 |                1 |\n|    6 |                3 |                2 |\n|    7 |                4 |                2 |\n|    8 |                4 |                2 |\n|    9 |                5 |                2 |\n|   10 |                5 |                2 |\n+------+------------------+------------------+\n10 rows in set (0.00 sec)\n"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+1\n    FROM\n        cte\n    WHERE\n    n<10\n)\nSELECT\n    n,\n    NTILE(5) OVER (),\n    NTILE(2) OVER ()\nFROM\n    cte;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["PERCENT_RANK()"], "Feature": ["PERCENT_RANK()"], "Description": ["PERCENT_RANK()", "PERCENT_RANK() \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u4ecb\u4e8e 0 \u548c 1 \u4e4b\u95f4\u7684\u6570\u5b57\uff0c\u8868\u793a\u503c\u5c0f\u4e8e\u5f53\u524d\u884c\u503c\u7684\u884c\u7684\u767e\u5206\u6bd4\u3002", "SELECT\n    *,\n    PERCENT_RANK() OVER (ORDER BY n),\n    PERCENT_RANK() OVER (ORDER BY n DESC)\nFROM (\n    SELECT 5 AS 'n'\n    UNION ALL\n    SELECT 8\n    UNION ALL\n    SELECT 5\n    UNION ALL\n    SELECT 30\n    UNION ALL\n    SELECT 31\n    UNION ALL\n    SELECT 32) a;\n", "+----+----------------------------------+---------------------------------------+\n| n  | PERCENT_RANK() OVER (ORDER BY n) | PERCENT_RANK() OVER (ORDER BY n DESC) |\n+----+----------------------------------+---------------------------------------+\n|  5 |                                0 |                                   0.8 |\n|  5 |                                0 |                                   0.8 |\n|  8 |                              0.4 |                                   0.6 |\n| 30 |                              0.6 |                                   0.4 |\n| 31 |                              0.8 |                                   0.2 |\n| 32 |                                1 |                                     0 |\n+----+----------------------------------+---------------------------------------+\n6 rows in set (0.00 sec)\n"], "Examples": ["SELECT\n    *,\n    PERCENT_RANK() OVER (ORDER BY n),\n    PERCENT_RANK() OVER (ORDER BY n DESC)\nFROM (\n    SELECT 5 AS 'n'\n    UNION ALL\n    SELECT 8\n    UNION ALL\n    SELECT 5\n    UNION ALL\n    SELECT 30\n    UNION ALL\n    SELECT 31\n    UNION ALL\n    SELECT 32) a;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["RANK()"], "Feature": ["RANK()"], "Description": ["RANK()", "RANK() \u51fd\u6570\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e DENSE_RANK()\uff0c\u4f46\u5728\u5904\u7406\u5177\u6709\u76f8\u540c\u503c\u548c\u6392\u5e8f\u6761\u4ef6\u7684\u884c\u65f6\u8fd4\u56de\u7684\u6392\u540d\u662f\u4e0d\u8fde\u7eed\u7684\u3002\u8fd9\u610f\u5473\u7740\u5b83\u63d0\u4f9b\u7684\u662f\u7edd\u5bf9\u6392\u540d\u3002\u4f8b\u5982\uff0c\u6392\u540d 7 \u610f\u5473\u7740\u6709 6 \u4e2a\u884c\u7684\u6392\u540d\u66f4\u9760\u524d\u3002", "SELECT\n    *,\n    RANK() OVER (ORDER BY n),\n    DENSE_RANK() OVER (ORDER BY n)\nFROM (\n    SELECT 5 AS 'n'\n    UNION ALL\n    SELECT 8\n    UNION ALL\n    SELECT 5\n    UNION ALL\n    SELECT 30\n    UNION ALL\n    SELECT 31\n    UNION ALL\n    SELECT 32) a;\n", "+----+--------------------------+--------------------------------+\n| n  | RANK() OVER (ORDER BY n) | DENSE_RANK() OVER (ORDER BY n) |\n+----+--------------------------+--------------------------------+\n|  5 |                        1 |                              1 |\n|  5 |                        1 |                              1 |\n|  8 |                        3 |                              2 |\n| 30 |                        4 |                              3 |\n| 31 |                        5 |                              4 |\n| 32 |                        6 |                              5 |\n+----+--------------------------+--------------------------------+\n6 rows in set (0.00 sec)\n"], "Examples": ["SELECT\n    *,\n    RANK() OVER (ORDER BY n),\n    DENSE_RANK() OVER (ORDER BY n)\nFROM (\n    SELECT 5 AS 'n'\n    UNION ALL\n    SELECT 8\n    UNION ALL\n    SELECT 5\n    UNION ALL\n    SELECT 30\n    UNION ALL\n    SELECT 31\n    UNION ALL\n    SELECT 32) a;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
{"HTML": ["https://docs.pingcap.com/zh/tidb/v8.3/window-functions"], "Title": ["ROW_NUMBER()"], "Feature": ["ROW_NUMBER()"], "Description": ["ROW_NUMBER()", "ROW_NUMBER() \u8fd4\u56de\u7ed3\u679c\u96c6\u4e2d\u5f53\u524d\u884c\u7684\u884c\u53f7\u3002", "WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+3\n    FROM\n        cte\n    WHERE\n        n<30\n)\nSELECT\n    n,\n    ROW_NUMBER() OVER ()\nFROM\n    cte;\n", "+------+----------------------+\n| n    | ROW_NUMBER() OVER () |\n+------+----------------------+\n|    1 |                    1 |\n|    4 |                    2 |\n|    7 |                    3 |\n|   10 |                    4 |\n|   13 |                    5 |\n|   16 |                    6 |\n|   19 |                    7 |\n|   22 |                    8 |\n|   25 |                    9 |\n|   28 |                   10 |\n|   31 |                   11 |\n+------+----------------------+\n11 rows in set (0.00 sec)\n"], "Examples": ["WITH RECURSIVE cte(n) AS (\n    SELECT\n        1\n    UNION\n    SELECT\n        n+3\n    FROM\n        cte\n    WHERE\n        n<30\n)\nSELECT\n    n,\n    ROW_NUMBER() OVER ()\nFROM\n    cte;\n"], "Category": ["\u7a97\u53e3\u51fd\u6570"]}
